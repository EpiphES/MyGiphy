(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var n=function(){function n(e,r,o,i){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t(this,"_handleNavigation",(function(e){e.preventDefault();var t=e.target.dataset.target;a._toggleButtonState(e.target),a._toggleView(t),history.pushState({},t,"#".concat(t))})),t(this,"_popPage",(function(){var e=location.hash.replace("#","");a._toggleView(e);var t=Array.from(a._controlsButtons).find((function(t){return t.dataset.target==e}));a._toggleButtonState(t)})),this._controls=document.querySelector(e),this._pages=document.querySelectorAll(r),this._controlsButtons=this._controls.querySelectorAll(".header__link"),this._handleTrending=o,this._handleRandom=i}var r,o;return r=n,(o=[{key:"init",value:function(){var e=this;this._controlsButtons.forEach((function(t){t.addEventListener("click",e._handleNavigation)})),this._controls.querySelector(".header__link_type_trending").addEventListener("click",this._handleTrending),this._controls.querySelector(".header__link_type_random").addEventListener("click",this._handleRandom),history.replaceState({},"search","#search"),window.addEventListener("popstate",this._popPage)}},{key:"_toggleButtonState",value:function(e){this._controls.querySelector(".header__link_active").classList.remove("header__link_active"),e.classList.add("header__link_active")}},{key:"_toggleView",value:function(e){document.querySelector(".view_active").classList.remove("view_active"),document.getElementById(e).classList.add("view_active")}}])&&e(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),n}();function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._downloadUrl=t,this._uploadUrl=n,this._apiKey=r}var t,n;return t=e,(n=[{key:"searchGifs",value:function(e){return fetch("".concat(this._downloadUrl,"/search?api_key=").concat(this._apiKey,"&q=").concat(e,"&limit=20")).then(this._checkResponse)}},{key:"getTrendingGifs",value:function(){return fetch("".concat(this._downloadUrl,"/trending?api_key=").concat(this._apiKey,"&limit=20")).then(this._checkResponse)}},{key:"getRandomGif",value:function(){return fetch("".concat(this._downloadUrl,"/random?api_key=").concat(this._apiKey)).then(this._checkResponse)}},{key:"uploadGifUrl",value:function(e,t){var n=new URLSearchParams;return n.append("source_image_url",e),n.append("tags",t),fetch("".concat(this._uploadUrl,"?api_key=").concat(this._apiKey,"&source_image_url=").concat(e,"&tags=").concat(t),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n}).then(this._checkResponse)}},{key:"uploadLocalGif",value:function(e,t){var n=new URLSearchParams;return n.append("file",e),n.append("tags",t),fetch("".concat(this._uploadUrl,"?api_key=").concat(this._apiKey,"&file=").concat(e,"&tags=").concat(t),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n}).then(this._checkResponse)}},{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Ошибка загрузки: ".concat(e.status))}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t,n){var r,o,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o=function(e){e.preventDefault(),i._handleFormSubmit(i._getInputValues(),i._form)},(r="_submitFormHandler")in this?Object.defineProperty(this,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[r]=o,this._form=document.querySelector(n),this._handleFormSubmit=t,this._inputList=this._form.querySelectorAll(".form__input"),this._resetButton=this._form.querySelector(".form__button_type_reset")}var t,n;return t=e,(n=[{key:"_getInputValues",value:function(){var e=this;return this._formValues={},this._inputList.forEach((function(t){return e._formValues[t.name]=t.value})),this._formValues}},{key:"setEventListeners",value:function(){var e=this;this._form.addEventListener("submit",this._submitFormHandler),this._resetButton.addEventListener("click",(function(){e._form.reset()}))}}])&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=u(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}function u(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function h(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return h(this,e)});function a(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=i.call(this,e,n))._handleResetSearch=t,r}return t=a,(n=[{key:"setEventListeners",value:function(){var e=this;s(d(a.prototype),"setEventListeners",this).call(this),this._resetButton.addEventListener("click",(function(){return e._handleResetSearch()}))}}])&&l(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(a);function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=function(){function e(t,n){var r,o,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o=function(){return document.querySelector(i._templateSelector).content.cloneNode(!0)},(r="_getTemplate")in this?Object.defineProperty(this,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[r]=o,this._templateSelector=n,this._cardData=t}var t,n;return t=e,(n=[{key:"generateCard",value:function(){return this._newCard=this._getTemplate(),this._cardImage=this._newCard.querySelector(".gallery__image"),this._cardTitle=this._newCard.querySelector(".gallery__title"),this._cardImage.src=this._cardData.images.downsized.url,this._cardImage.alt=this._cardData.title,this._cardTitle.textContent=this._cardData.title,this._newCard}}])&&_(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),m(this,"_renderer",void 0),m(this,"_container",void 0),this._renderer=t,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"renderItems",value:function(e){var t=this;e.forEach((function(e){return t.addItem(e)}))}},{key:"addItem",value:function(e){var t=this._renderer(e);this._container.append(t)}},{key:"resetList",value:function(){for(;this._container.firstChild;)this._container.removeChild(this._container.firstChild)}}])&&v(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._card=document.querySelector(t),this._image=this._card.querySelector(".single-card__image"),this._title=this._card.querySelector(".single-card__title")}var t,n;return t=e,(n=[{key:"showCard",value:function(e){this._image.src=e.images.downsized.url,this._image.alt=e.title,this._title.textContent=e.title}},{key:"cleanCard",value:function(){this._image.src="/",this._image.alt="",this._title.textContent=""}}])&&b(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),k=new o("https://api.giphy.com/v1/gifs","https://upload.giphy.com/v1/gifs","U5zS22kTjXKZUEQVNwtDWaGWJZFSGT1L");new n(".header__controls",".view",(function(){k.getTrendingGifs().then((function(e){O.resetList(),O.renderItems(e.data)})).catch((function(e){return console.log(e)}))}),(function(){P.cleanCard(),k.getRandomGif().then((function(e){P.showCard(e.data)})).catch((function(e){return console.log(e)}))})).init(),new p((function(e){var t=e.search;k.searchGifs(t).then((function(e){S.resetList(),S.renderItems(e.data)})).then((function(){})).catch((function(e){return console.log(e)}))}),(function(){S.resetList()}),".form_type_search").setEventListeners(),new a((function(e,t){var n=e.url,r=e.urltags.trim().replaceAll(","," ").replace(/\s+/g,", ");k.uploadGifUrl(n,r).then((function(){alert("Ссылка отправлена"),t.reset()})).catch((function(e){return console.log(e)}))}),".form_type_upload").setEventListeners();var S=new g(j,".gallery_place_search"),O=new g(j,".gallery_place_trending"),P=new w(".single-card");function j(e){return new y(e,".gallery__template").generateCard()}})();
//# sourceMappingURL=main.js.map